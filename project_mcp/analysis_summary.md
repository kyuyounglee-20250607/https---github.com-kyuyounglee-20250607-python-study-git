# Jupyter Notebook 파일 분석 결과

## 개요

분석한 노트북들은 주로 **서울시 상권분석 데이터**와 **도소매업 고객 데이터**를 다루고 있습니다. 주요 작업은 다음과 같습니다.

1.  **데이터 수집**: 서울시 열린데이터광장 API를 호출하여 상권 데이터를 가져옵니다.
2.  **데이터 전처리**: 가져온 데이터를 Pandas DataFrame으로 변환하고, 컬럼명을 한글로 변경하며 불필요한 데이터를 정리합니다.
3.  **데이터 분석 및 시각화**: 업종별 매출 순위, 비율, 요일별 패턴 등을 분석하고 막대그래프, 파이 차트 등으로 시각화합니다.
4.  **데이터 저장**: 분석 결과를 CSV 파일과 이미지 파일로 저장합니다.
5.  **엑셀 보고서 생성**: 분석된 데이터를 여러 시트로 나누어 엑셀 파일로 만들고, 차트를 포함시킵니다.
6.  **지하철 API 활용**: 서울시 지하철 실시간 도착 정보를 활용하여 역 코드와 역명을 매핑하는 작업을 수행합니다.

---

## 파일별 상세 분석

### 1. `6.openapi_seoul` 폴더

이 폴더의 노트북들은 **서울시 상권분석**에 초점을 맞추고 있습니다.

*   **`01.ipynb`**:
    *   서울시 상권분석 API를 호출하여 데이터를 가져옵니다.
    *   가져온 JSON 데이터를 Pandas DataFrame으로 변환합니다.
    *   컬럼명을 영문에서 한글로 변경합니다.
    *   처리된 데이터를 `seoul_store.csv` 파일로 저장합니다.

*   **`01_improved.ipynb`**:
    *   `01.ipynb`의 개선 버전입니다.
    *   **에러 처리 강화**: API 호출 시 발생할 수 있는 타임아웃, HTTP 오류 등을 처리하기 위해 재시도 로직을 추가했습니다.
    *   **로깅 기능**: 데이터 수집 및 처리 과정의 주요 단계를 로그로 남겨 추적하기 용이하게 만들었습니다.
    *   **파일 저장 개선**: 저장하는 CSV 파일명에 현재 시간을 포함시켜(`seoul_store_YYYYMMDD_HHMMSS.csv`), 기존 파일을 덮어쓰지 않도록 했습니다.

*   **`03.ipynb`**:
    *   `seoul_store.csv` 파일을 읽어옵니다.
    *   `matplotlib`과 `seaborn`을 사용하여 업종별 당월 매출 상위 10개를 막대그래프로 시각화합니다.
    *   한글 폰트 설정을 포함하고 있습니다.

*   **`03_improved.ipynb`**:
    *   `03.ipynb`의 개선 버전입니다.
    *   **다양한 시각화**:
        *   매출 상위 10개 업종을 보여주는 **가로 막대그래프**와 **파이 차트**를 추가했습니다.
        *   상위 5개 업종의 **요일별 매출 패턴**을 보여주는 라인 그래프를 추가했습니다.
    *   **시각화 개선**: 그래프에 "조원" 단위를 표시하고, 값을 막대 위에 표시하는 등 가독성을 높였습니다.
    *   **그래프 저장**: 생성된 모든 그래프를 타임스탬프가 포함된 PNG 파일로 자동 저장하는 기능을 추가했습니다.
    *   **분석 요약**: 마지막에 총 분석 업종 수, 상위 매출 정보 등을 요약하여 출력합니다.

*   **`04.ipynb`**:
    *   서울시 **지하철 실시간 도착 정보 API**를 사용합니다.
    *   '강남'역의 도착 정보를 예시로 가져옵니다.
    *   2호선 전체 역의 역명과 역 코드(station ID)를 매핑하는 테이블을 만듭니다.
    *   역 코드를 역명으로 변환하는 함수를 정의하고, 특정 역의 이전/다음 역 정보를 조회하는 코드를 포함합니다.

### 2. `4.excel` 폴더

이 폴더의 노트북은 **도소매 고객 데이터**를 분석하고 **엑셀 보고서**를 생성하는 데 중점을 둡니다.

*   **`01.ipynb`**:
    *   URL로부터 도소매 고객 데이터(`wolesale_customers.csv`)를 읽어옵니다.
    *   'Channel'(거래 채널), 'Region'(지역) 등의 컬럼을 알아보기 쉬운 한글 값(예: '소매점', 'lisbon')으로 변경합니다.
    *   채널별, 지역별로 상품 카테고리(신선식품, 유제품 등)의 합계를 계산합니다.
    *   `pandas.ExcelWriter`를 사용하여 여러 DataFrame(원본 데이터, 지역별 집계, 채널별 집계)을 하나의 엑셀 파일(`report.xlsx`)에 다른 시트로 저장합니다.
    *   `xlsxwriter` 엔진을 사용하여 엑셀 파일에 **차트를 포함**시키는 방법을 보여줍니다. (`report_region.xlsx`, `report_chart.xlsx`)

---

## 요약

*   **데이터 소스**: 서울시 상권 데이터 (API), 도소매 고객 데이터 (CSV)
*   **주요 기술**: `requests` (API 호출), `pandas` (데이터 분석), `matplotlib`, `seaborn` (시각화), `openpyxl`, `xlsxwriter` (엑셀 처리)
*   **프로세스**: 데이터 수집 → 전처리 → 분석/시각화 → 결과 저장 (CSV, PNG, XLSX)
*   **특징**:
    *   단순 코드 실행에서 **에러 처리, 로깅, 설정 분리** 등 점차 코드를 개선하는 과정을 보여줍니다 (`_improved` 파일들).
    *   데이터 분석 결과를 단순히 출력하는 것을 넘어, **다양한 형태의 시각화**와 **엑셀 보고서 자동 생성**까지 다루고 있습니다.
